
/* !!! This is code generated by Prisma. Do not edit directly. !!! */
/* eslint-disable */
// @ts-nocheck 
import * as $runtime from "@prisma/client/runtime/library"

/**
 * @param text
 */
export const getListStatistics = $runtime.makeTypedQueryFactory("WITH CacheStats AS (\nSELECT\n\"fieldId\",\n\"itemId\",\nBOOL_OR(\"id\" IS NOT NULL) as has_cache,\nBOOL_OR(\n\"enrichmentErrorMessage\" IS NULL\nAND (\"valueString\" IS NOT NULL\nOR \"valueNumber\" IS NOT NULL\nOR \"valueDate\" IS NOT NULL\nOR \"valueBoolean\" IS NOT NULL)\n) as has_value,\nBOOL_OR(\n\"failedEnrichmentValue\" IS NOT NULL\n) as has_missing\nFROM \"AiListItemCache\"\nWHERE \"fieldId\" IN (SELECT \"id\" FROM \"AiListField\" WHERE \"listId\" = $1)\nGROUP BY \"fieldId\", \"itemId\"\n),\nTaskCounts AS (\nSELECT\n\"fieldId\",\nCOUNT(*) as total_count,\nCOUNT(CASE WHEN \"completedAt\" IS NOT NULL THEN 1 END) as completed_count,\nCOUNT(CASE WHEN \"error\" IS NOT NULL THEN 1 END) as error_count,\nCOUNT(CASE WHEN \"startedAt\" IS NULL THEN 1 END) as pending_count,\nCOUNT(CASE WHEN \"startedAt\" IS NOT NULL AND \"completedAt\" IS NULL THEN 1 END) as processing_count,\nAVG(EXTRACT(EPOCH FROM (\"completedAt\" - \"startedAt\"))) as processing_duration_seconds\nFROM \"AiEnrichmentTask\"\nWHERE \"fieldId\" IN (SELECT \"id\" FROM \"AiListField\" WHERE \"listId\" = $1)\nGROUP BY \"fieldId\"\n)\nSELECT\n\"field\".\"id\" as \"fieldId\",\n\"field\".\"listId\" as \"listId\",\n\"field\".\"name\" as \"fieldName\",\nCOUNT(DISTINCT \"item\".\"id\") as \"itemCount\",\nCOUNT(DISTINCT CASE WHEN \"cache\".has_cache THEN \"item\".\"id\" END) as \"cacheCount\",\nCOUNT(DISTINCT CASE WHEN \"cache\".has_value THEN \"item\".\"id\" END) as \"valuesCount\",\nCOUNT(DISTINCT CASE WHEN \"cache\".has_missing THEN \"item\".\"id\" END) as \"missingCount\",\nCOALESCE(MAX(\"tasks\".total_count), 0) as \"totalTasksCount\",\nCOALESCE(MAX(\"tasks\".completed_count), 0) as \"completedTasksCount\",\nCOALESCE(MAX(\"tasks\".error_count), 0) as \"errorTasksCount\",\nCOALESCE(MAX(\"tasks\".pending_count), 0) as \"pendingTasksCount\",\nCOALESCE(MAX(\"tasks\".processing_count), 0) as \"processingTasksCount\",\nCOALESCE(MAX(\"tasks\".processing_duration_seconds), 0) as \"averageProcessingDurationSeconds\"\nFROM \"AiList\" as \"list\"\nINNER JOIN \"AiListField\" as \"field\" ON \"field\".\"listId\" = \"list\".\"id\" AND \"field\".\"sourceType\" = 'llm_computed'\nLEFT JOIN \"AiListItem\" as \"item\" ON \"item\".\"listId\" = \"list\".\"id\"\nLEFT JOIN CacheStats as \"cache\" ON \"cache\".\"fieldId\" = \"field\".\"id\"\nAND \"cache\".\"itemId\" = \"item\".\"id\"\nLEFT JOIN TaskCounts as \"tasks\" ON \"tasks\".\"fieldId\" = \"field\".\"id\"\nWHERE \"list\".\"id\" = $1\nGROUP BY \"field\".\"id\", \"field\".\"listId\", \"field\".\"name\"\nORDER BY \"field\".\"name\" ASC") as (text: string) => $runtime.TypedSql<getListStatistics.Parameters, getListStatistics.Result>

export namespace getListStatistics {
  export type Parameters = [text: string]
  export type Result = {
    fieldId: string
    listId: string
    fieldName: string
    itemCount: bigint | null
    cacheCount: bigint | null
    valuesCount: bigint | null
    missingCount: bigint | null
    totalTasksCount: bigint | null
    completedTasksCount: bigint | null
    errorTasksCount: bigint | null
    pendingTasksCount: bigint | null
    processingTasksCount: bigint | null
    averageProcessingDurationSeconds: $runtime.Decimal | null
  }
}
