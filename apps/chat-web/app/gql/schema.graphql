schema {
  query: Query
  mutation: Mutation
}

"""
AI Act Legal Disclaimer
"""
type AIActLegalDisclaimer {
  text: AiActString!
  title: AiActString!
}

"""
AI Act Assessment Query
"""
type AiActAssessment {
  assistantId: String!
  assistantSurvey: AiActAssistantSurvey!
  identifyRiskInfo: AiActIdentifyRisksInfo!
}

"""
AI Act Assessment Basic System Info
"""
type AiActAssistantSurvey {
  actions: [AiActRecommendedAction!]!
  actionsTitle: AiActString!
  assistantId: String!
  hint: AiActString!
  id: String!
  percentCompleted: Int!
  questions: [AiActQuestion!]!
  riskIndicator: AiActRiskIndicator!
  title: AiActString!
}

"""
AI Act Compliance Area
"""
type AiActComplianceArea {
  description: AiActString!
  id: String!
  mandatory: Boolean!
  title: AiActString!
}

"""
AI Act Identify Risks Info
"""
type AiActIdentifyRisksInfo {
  complianceAreas: [AiActComplianceArea!]!
  legalDisclaimer: AIActLegalDisclaimer!
  title: AiActString!
}

type AiActOption {
  id: String!
  risk: AiActOptionRisk
  title: AiActString!
}

type AiActOptionRisk {
  description: AiActString!
  points: Int!
  riskLevel: String
}

"""
AI Act Questions
"""
type AiActQuestion {
  hint: AiActString!
  id: String!
  notes: String
  options: [AiActOption!]!
  title: AiActString!
  value: String
}

"""
AI Act Checklist Action
"""
type AiActRecommendedAction {
  description: AiActString!
  level: String!
}

"""
AI Act Risk Indicator
"""
type AiActRiskIndicator {
  description: AiActString!
  factors: [AiActString!]!
  level: String!
}

type AiActString {
  de: String!
  en: String!
}

type AiAssistant {
  baseCases: [AiAssistantBaseCase!]!
  createdAt: DateTime!
  description: String
  iconUrl: String
  id: ID!
  languageModel: String
  name: String!
  ownerId: ID!
  updatedAt: DateTime
  url: String
  users: [User!]!
}

type AiAssistantBaseCase {
  assistant: AiAssistant
  condition: String
  createdAt: DateTime!
  id: ID
  instruction: String
  sequence: Float
  updatedAt: DateTime
}

input AiAssistantInput {
  description: String
  icon: String
  languageModel: String
  name: String!
  url: String
}

input AiBaseCaseInputType {
  condition: String
  id: String
  instruction: String
  sequence: Float
}

"""
AI Chat Models available in the system
"""
type AiChatModel {
  model: String!
  name: String!
}

type AiConversation {
  assistants: [AiAssistant!]!
  createdAt: DateTime!
  humans: [User!]!
  id: ID!
  messages: [AiConversationMessage!]!
  owner: User!
  ownerId: String!
  participants: [AiConversationParticipant!]!
  updatedAt: DateTime
}

input AiConversationCreateInput {
  assistantIds: [String!]!
  userIds: [String!]!
}

type AiConversationMessage {
  content: String
  conversation: AiConversation
  conversationId: ID!
  createdAt: DateTime!
  hidden: Boolean
  id: ID!
  sender: AiConversationParticipant!
  senderId: ID!
  sequenceNumber: BigInt!
  source: String
  updatedAt: DateTime
}

input AiConversationMessageInput {
  content: String!
  conversationId: String!
  recipientAssistantIds: [String!]!
}

interface AiConversationParticipant {
  assistant: AiAssistant
  assistantId: ID
  conversation: AiConversation
  conversationId: ID!
  id: ID!
  isAssistant: Boolean
  isBot: Boolean!
  isHuman: Boolean
  name: String
  user: User
  userId: ID
}

"""
AI Embedding Models available in the system
"""
type AiEmbeddingModel {
  model: String!
  name: String!
}

"""
File converter option for AI Library
"""
type AiFileConverterOption {
  description: AiFileConverterOptionText!
  label: AiFileConverterOptionText!
  name: String!
}

"""
Text representation of a file converter option
"""
type AiFileConverterOptionText {
  de: String!
  en: String!
}

"""
Options for converting files in AI Library
"""
type AiFileConverterOptions {
  """
  PDF processing options
  """
  pdf: AiFileConverterOptionsSection!
}

"""
Section of file converter options
"""
type AiFileConverterOptionsSection {
  settings: [AiFileConverterOption!]!
  title: AiFileConverterOptionText!
}

type AiLibrary {
  crawlers: [AiLibraryCrawler!]!
  createdAt: DateTime!
  description: String
  embeddingModelName: String
  fileConverterOptions: String
  files: [AiLibraryFile!]!
  filesCount: Int!
  id: ID!
  name: String!
  owner: User!
  ownerId: String!
  updatedAt: DateTime!
  url: String
  users: [User!]!
}

type AiLibraryCrawler {
  allowedMimeTypes: String
  createdAt: DateTime!
  cronJob: AiLibraryCrawlerCronJob
  excludePatterns: String
  filesCount: Int!
  id: ID!
  includePatterns: String
  isRunning: Boolean!
  lastRun: AiLibraryCrawlerRun
  libraryId: String!
  maxDepth: Int!
  maxFileSize: Int
  maxPages: Int!
  minFileSize: Int
  runCount: Int!
  runs(skip: Int! = 0, take: Int! = 10): [AiLibraryCrawlerRun!]!
  updatedAt: DateTime!
  uri: String!
  uriType: AiLibraryCrawlerUriType!
}

input AiLibraryCrawlerCredentialsInput {
  password: String
  sharepointAuth: String
  username: String
}

type AiLibraryCrawlerCronJob {
  active: Boolean!
  createdAt: DateTime!
  cronExpression: String
  friday: Boolean!
  hour: Int!
  id: ID!
  minute: Int!
  monday: Boolean!
  saturday: Boolean!
  sunday: Boolean!
  thursday: Boolean!
  tuesday: Boolean!
  updatedAt: DateTime!
  wednesday: Boolean!
}

input AiLibraryCrawlerCronJobInput {
  active: Boolean!
  friday: Boolean!
  hour: Int!
  minute: Int!
  monday: Boolean!
  saturday: Boolean!
  sunday: Boolean!
  thursday: Boolean!
  tuesday: Boolean!
  wednesday: Boolean!
}

input AiLibraryCrawlerInput {
  allowedMimeTypes: [String!]
  cronJob: AiLibraryCrawlerCronJobInput
  excludePatterns: [String!]
  includePatterns: [String!]
  maxDepth: Int!
  maxFileSize: Int
  maxPages: Int!
  minFileSize: Int
  uri: String!
  uriType: AiLibraryCrawlerUriType!
}

type AiLibraryCrawlerRun {
  crawler: AiLibraryCrawler!
  crawlerId: ID!
  endedAt: DateTime
  errorMessage: String
  filteredUpdatesCount(updateTypeFilter: [String!]): Int!
  id: ID!
  runByUserId: ID
  startedAt: DateTime!
  stoppedByUser: DateTime
  success: Boolean
  updateStats: [UpdateStats!]!
  updates(skip: Int! = 0, take: Int! = 10, updateTypeFilter: [String!]): [AiLibraryUpdate!]!
  updatesCount: Int!
}

enum AiLibraryCrawlerUriType {
  http
  sharepoint
  smb
}

type AiLibraryFile {
  archivedAt: DateTime
  cache: [AiListItemCache!]!
  chunks: Int
  crawledByCrawler: AiLibraryCrawler
  createdAt: DateTime!
  docPath: String
  dropError: String
  fieldValues(fieldIds: [String!]!, language: String!): [FieldValueResult!]!
  id: ID!
  lastUpdate: AiLibraryUpdate
  libraryId: String!
  mimeType: String!
  name: String!
  originModificationDate: DateTime
  originUri: String
  processedAt: DateTime
  processingEndedAt: DateTime
  processingErrorAt: DateTime
  processingErrorMessage: String
  processingStartedAt: DateTime
  size: Int
  updatedAt: DateTime
  uploadedAt: DateTime
}

input AiLibraryFileInput {
  libraryId: String!
  mimeType: String!
  name: String!
  originUri: String!
}

"""
Query result for AI library files
"""
type AiLibraryFileQueryResult {
  archivedCount: Int!
  count: Int!
  files: [AiLibraryFile!]!
  library: AiLibrary!
  libraryId: String!
  showArchived: Boolean
  skip: Int!
  take: Int!
}

input AiLibraryInput {
  description: String
  embeddingModelName: String
  fileConverterOptions: String
  icon: String
  name: String!
  url: String
}

type AiLibraryQueryHit {
  docId: String!
  docName: String!
  docPath: String!
  highlights: [AiLibraryQueryHitHighlight!]!
  id: String!
  originUri: String!
  pageContent: String!
}

type AiLibraryQueryHitHighlight {
  field: String!
  snippet: String
}

type AiLibraryQueryResult {
  hitCount: Int!
  hits: [AiLibraryQueryHit!]!
  libraryId: String!
  query: String!
  skip: Int!
  take: Int!
}

type AiLibraryUpdate {
  crawlerRun: AiLibraryCrawlerRun
  crawlerRunId: ID
  createdAt: DateTime!
  file: AiLibraryFile
  fileId: ID
  fileName: String
  filePath: String
  fileSize: Int
  filterType: String
  filterValue: String
  id: ID!
  library: AiLibrary
  libraryId: ID!
  message: String
  updateType: String!
}

"""
Query result for AI library updates
"""
type AiLibraryUpdateQueryResult {
  count: Int!
  crawlerId: String
  library: AiLibrary!
  libraryId: String!
  skip: Int!
  take: Int!
  updates: [AiLibraryUpdate!]!
}

type AiLibraryUsage {
  assistant: AiAssistant!
  assistantId: ID!
  createdAt: DateTime!
  id: ID!
  library: AiLibrary!
  libraryId: ID!
  updatedAt: DateTime!
  usedFor: String
}

type AiList {
  createdAt: DateTime!
  enrichmentQueue: [AiListEnrichmentQueue!]!
  fields: [AiListField!]!
  id: ID!
  name: String!
  owner: User!
  ownerId: String!
  participants: [AiListParticipant!]!
  sources: [AiListSource!]!
  updatedAt: DateTime
}

type AiListEnrichmentQueue {
  completedAt: DateTime
  error: String
  field: AiListField!
  fieldId: String!
  file: AiLibraryFile!
  fileId: String!
  id: ID!
  list: AiList!
  listId: String!
  priority: Int!
  requestedAt: DateTime!
  startedAt: DateTime
  status: String!
}

type AiListField {
  context: [AiListFieldContext!]!
  fileProperty: String
  id: ID!
  languageModel: String
  name: String!
  order: Int!
  pendingItemsCount: Int!
  prompt: String
  sourceType: String!
  type: String!
  useMarkdown: Boolean
}

type AiListFieldContext {
  contextField: AiListField!
  contextFieldId: String!
  createdAt: DateTime!
  field: AiListField!
  fieldId: String!
}

input AiListFieldInput {
  context: [String!]
  fileProperty: String
  languageModel: String
  name: String!
  order: Int
  prompt: String
  """
  Source type: file_property or llm_computed
  """
  sourceType: String!
  """
  Field type: string, number, date, datetime, boolean
  """
  type: String!
  useMarkdown: Boolean
}

"""
Query result for AI list files from all source libraries
"""
type AiListFilesQueryResult {
  count: Int!
  files: [AiLibraryFile!]!
  listId: String!
  orderBy: String
  orderDirection: String
  showArchived: Boolean
  skip: Int!
  take: Int!
}

input AiListInput {
  name: String!
}

type AiListItemCache {
  fieldId: String!
  id: ID!
  valueBoolean: Boolean
  valueDate: DateTime
  valueNumber: Float
  valueString: String
}

type AiListParticipant {
  id: ID!
  list: AiList!
  listId: String!
  user: AiList!
  userId: String!
}

type AiListSource {
  createdAt: DateTime!
  id: ID!
  library: AiLibrary
  libraryId: String
  listId: String!
}

input AiListSourceInput {
  libraryId: String!
}

type AssistantParticipant implements AiConversationParticipant {
  assistant: AiAssistant
  assistantId: ID
  conversation: AiConversation
  conversationId: ID!
  id: ID!
  isAssistant: Boolean
  isBot: Boolean!
  isHuman: Boolean
  name: String
  user: User
  userId: ID
}

scalar BigInt

type CleanEnrichmentResult {
  clearedItems: Int
  error: String
  success: Boolean
}

type ComputeFieldValueResult {
  error: String
  success: Boolean
  value: String
}

input ConversationInvitationInput {
  allowDifferentEmailAddress: Boolean!
  allowMultipleParticipants: Boolean!
  email: String!
}

"""
A date string, such as 2007-12-03, compliant with the `full-date` format outlined in section 5.6 of the RFC 3339 profile of the ISO 8601 standard for representation of dates and times using the Gregorian calendar.
"""
scalar Date

"""
A date-time string at UTC, such as 2007-12-03T10:15:30Z, compliant with the `date-time` format outlined in section 5.6 of the RFC 3339 profile of the ISO 8601 standard for representation of dates and times using the Gregorian calendar.
"""
scalar DateTime

scalar Decimal

type EnrichmentQueueResult {
  error: String
  queuedItems: Int
  success: Boolean
}

type FieldValueResult {
  displayValue: String
  fieldId: String!
  fieldName: String!
}

type FileChunk {
  chunkIndex: Int!
  headingPath: String!
  id: String!
  section: String!
  subChunkIndex: Int!
  text: String!
}

type FileChunkQueryResponse {
  chunks: [FileChunk!]!
  count: Int!
  fileId: String!
  fileName: String
  libraryId: String!
  skip: Int!
  take: Int!
}

type HumanParticipant implements AiConversationParticipant {
  assistant: AiAssistant
  assistantId: ID
  conversation: AiConversation
  conversationId: ID!
  id: ID!
  isAssistant: Boolean
  isBot: Boolean!
  isHuman: Boolean
  name: String
  user: User
  userId: ID
}

type ManagedUser {
  activationDate: DateTime
  avatarUrl: String
  business: String
  confirmationDate: DateTime
  createdAt: DateTime!
  email: String!
  family_name: String
  given_name: String
  id: ID!
  isAdmin: Boolean!
  lastLogin: DateTime
  name: String
  position: String
  registered: Boolean
  updatedAt: DateTime
  username: String!
}

type ManagedUsersResponse {
  filter: String
  skip: Int!
  statusFilter: String
  take: Int!
  userStatistics: UserStatistic!
  users: [ManagedUser!]!
}

type Mutation {
  activateUserProfile(profileId: String!): UserProfile
  addAssistantParticipants(assistantId: String!, userIds: [String!]!): [User!]!
  addConversationParticipants(
    assistantIds: [String!]
    conversationId: String!
    userIds: [String!]
  ): [AiConversationParticipant!]
  addLibraryParticipants(libraryId: String!, userIds: [String!]!): [User!]!
  addLibraryUsage(assistantId: String!, libraryId: String!): AiLibraryUsage
  addListField(data: AiListFieldInput!, listId: String!): AiListField!
  addListSource(data: AiListSourceInput!, listId: String!): AiListSource!
  cancelFileUpload(fileId: String!, libraryId: String!): Boolean!
  cleanListEnrichments(
    """
    Field ID to clean
    """
    fieldId: String!
    listId: String!
  ): CleanEnrichmentResult!
  clearEmbeddedFiles(libraryId: String!): Boolean
  computeFieldValue(fieldId: String!, fileId: String!): ComputeFieldValueResult
  confirmConversationInvitation(conversationId: String!, invitationId: String!): AiConversation
  confirmUserProfile(profileId: String!): UserProfile
  createAiAssistant(name: String!): AiAssistant
  createAiConversation(data: AiConversationCreateInput!): AiConversation
  createAiLibrary(data: AiLibraryInput!): AiLibrary
  createAiLibraryCrawler(
    credentials: AiLibraryCrawlerCredentialsInput
    data: AiLibraryCrawlerInput!
    libraryId: String!
  ): AiLibraryCrawler
  createContactRequest(emailOrPhone: String!, message: String!, name: String!): Boolean!
  createConversationInvitations(conversationId: String!, data: [ConversationInvitationInput!]!): AiConversation
  createList(data: AiListInput!): AiList!
  deleteAiAssistant(assistantId: String!): AiAssistant
  deleteAiConversation(conversationId: String!): AiConversation
  deleteAiConversations(conversationIds: [String!]!): Boolean!
  deleteAiLibrary(id: String!): Boolean
  deleteAiLibraryCrawler(id: String!): AiLibraryCrawler
  deleteList(id: String!): AiList!
  deleteMessage(messageId: String!): AiConversationMessage
  dropFile(fileId: String!): AiLibraryFile!
  dropFiles(libraryId: String!): [AiLibraryFile!]!
  ensureUserProfile(userId: String!): UserProfile
  hideMessage(messageId: String!): AiConversationMessage
  leaveAiConversation(participantId: String!): AiConversationParticipant
  leaveAssistantParticipant(assistantId: String!): User
  leaveLibraryParticipant(libraryId: String!): User
  login(jwtToken: String!): User
  prepareFile(data: AiLibraryFileInput!): AiLibraryFile
  processFile(fileId: String!): AiLibraryFile!
  removeAssistantParticipant(assistantId: String!, userId: String!): User!
  removeConversationParticipant(participantId: String!): AiConversationParticipant
  removeLibraryParticipant(libraryId: String!, userId: String!): User!
  removeLibraryUsage(assistantId: String!, libraryId: String!): AiLibraryUsage
  removeListField(id: String!): AiListField!
  removeListSource(id: String!): AiListSource!
  resetAssessmentAnswers(assistantId: String!): DateTime!
  runAiLibraryCrawler(crawlerId: String!): String!
  sendConfirmationMail(activationUrl: String!, confirmationUrl: String!): Boolean
  sendMessage(data: AiConversationMessageInput!): [AiConversationMessage!]!
  startListEnrichment(
    """
    Field ID to enrich
    """
    fieldId: String!
    listId: String!
  ): EnrichmentQueueResult!
  startSingleEnrichment(
    """
    Field ID to enrich
    """
    fieldId: String!
    """
    File ID to enrich
    """
    fileId: String!
    listId: String!
  ): EnrichmentQueueResult!
  stopAiLibraryCrawler(crawlerId: String!): String!
  stopListEnrichment(
    """
    Field ID to stop enrichment for
    """
    fieldId: String!
    listId: String!
  ): EnrichmentQueueResult!
  toggleAdminStatus(userId: String!): User
  unhideMessage(messageId: String!): AiConversationMessage
  updateAiAssistant(data: AiAssistantInput!, id: String!): AiAssistant
  updateAiLibrary(data: AiLibraryInput!, id: String!): AiLibrary
  updateAiLibraryCrawler(
    credentials: AiLibraryCrawlerCredentialsInput
    data: AiLibraryCrawlerInput!
    id: String!
  ): AiLibraryCrawler
  updateAssessmentQuestion(assistantId: String!, notes: String, questionId: String!, value: String): DateTime!
  updateLibraryUsage(id: String!, usedFor: String): AiLibraryUsage
  updateList(data: AiListInput!, id: String!): AiList
  updateListField(data: AiListFieldInput!, id: String!): AiListField!
  updateMessage(content: String!, messageId: String!): AiConversationMessage
  updateUserAvatar(avatarUrl: String): User
  updateUserProfile(input: UserProfileInput!, profileId: String!): UserProfile
  upsertAiBaseCases(assistantId: String!, baseCases: [AiBaseCaseInputType!]!): [AiAssistantBaseCase!]
  validateSharePointConnection(sharepointAuth: String!, uri: String!): SharePointValidationResult!
}

type Query {
  aiActAssessment(assistantId: String!): AiActAssessment!
  aiAssistant(assistantId: String!): AiAssistant
  aiAssistants: [AiAssistant!]!
  aiChatModels: [AiChatModel!]!
  aiConversation(conversationId: String!): AiConversation
  aiConversationMessages(conversationId: String!): [AiConversationMessage!]
  aiConversations: [AiConversation!]!
  aiEmbeddingModels: [AiEmbeddingModel!]!
  aiFileChunks(fileId: String!, libraryId: String!, skip: Int!, take: Int!): FileChunkQueryResponse!
  aiFileConverterOptions: AiFileConverterOptions!
  aiLibraries: [AiLibrary!]!
  aiLibrary(libraryId: String!): AiLibrary!
  aiLibraryCrawler(crawlerId: String!, libraryId: String!): AiLibraryCrawler!
  aiLibraryCrawlerRun(crawlerRunId: String!, libraryId: String!): AiLibraryCrawlerRun!
  aiLibraryFile(fileId: String!, libraryId: String!): AiLibraryFile!
  aiLibraryFiles(
    libraryId: String!
    showArchived: Boolean = false
    skip: Int! = 0
    take: Int! = 20
  ): AiLibraryFileQueryResult!
  aiLibraryUpdates(crawlerId: ID, libraryId: ID!, skip: Int = 0, take: Int = 10): AiLibraryUpdateQueryResult!
  aiLibraryUsage(assistantId: String, libraryId: String): [AiLibraryUsage!]!
  aiList(id: String!): AiList!
  aiListEnrichmentQueue(listId: String!, status: String): [AiListEnrichmentQueue!]!
  aiListFiles(
    listId: String!
    orderBy: String
    orderDirection: String
    showArchived: Boolean = false
    skip: Int! = 0
    take: Int! = 20
  ): AiListFilesQueryResult!
  aiLists: [AiList!]!
  managedUsers(filter: String, skip: Int! = 0, statusFilter: String, take: Int! = 100): ManagedUsersResponse!
  queryAiLibraryFiles(libraryId: String!, query: String!, skip: Int!, take: Int!): AiLibraryQueryResult!
  readFileMarkdown(fileId: String!, libraryId: String!): String!
  user(email: String!): User
  userProfile: UserProfile
  users: [User!]!
  version: String
}

type SharePointValidationResult {
  errorMessage: String
  errorType: String
  success: Boolean
}

type UpdateStats {
  count: Int
  updateType: String
}

type User {
  avatarUrl: String
  createdAt: DateTime!
  email: String!
  family_name: String
  given_name: String
  id: ID!
  isAdmin: Boolean!
  lastLogin: DateTime
  name: String
  profile: UserProfile
  registered: Boolean
  updatedAt: DateTime
  username: String!
}

input UserInput {
  avatarUrl: String
  email: String!
  family_name: String
  given_name: String
  name: String!
}

type UserProfile {
  activationDate: DateTime
  business: String
  confirmationDate: DateTime
  createdAt: DateTime!
  email: String!
  expiresAt: DateTime
  firstName: String
  freeMessages: Int!
  freeStorage: Int!
  id: ID!
  lastName: String
  position: String
  updatedAt: DateTime
  usedMessages: Int
  usedStorage: Int
  userId: ID!
}

input UserProfileInput {
  business: String
  email: String!
  firstName: String
  freeMessages: Int
  freeStorage: Int
  lastName: String
  position: String
}

type UserStatistic {
  activated: Int!
  confirmed: Int!
  total: Int!
  unactivated: Int!
  unconfirmed: Int!
}
